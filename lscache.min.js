!function(a,b){"function"==typeof define&&define.amd?define([],b):"undefined"!=typeof module&&module.exports?module.exports=b():a.lscache=b()}(this,function(){function a(){var a="__lscachetest__",b=a;if(void 0!==i)return i;try{f(a,b),g(a),i=!0}catch(c){i=!1}return i}function b(){return void 0===j&&(j=null!=window.JSON),j}function c(a){return a+l}function d(){return Math.floor((new Date).getTime()/n)}function e(a){return q.getItem(k+r+a)}function f(a,b){q.removeItem(k+r+a),q.setItem(k+r+a,b)}function g(a){q.removeItem(k+r+a)}function h(a,b){s&&"console"in window&&"function"==typeof window.console.warn&&(window.console.warn("lscache - "+a),b&&window.console.warn("lscache - The error was: "+b.message))}var i,j,k="lscache-",l="-cacheexpiration",m=10,n=6e4,o=Math.floor(864e13/n),p={LOCAL:localStorage,SESSION:sessionStorage},q=p.LOCAL,r="",s=!1,t={set:function(i,j,n){if(a()){if("string"!=typeof j){if(!b())return;try{j=JSON.stringify(j)}catch(p){return}}try{f(i,j)}catch(p){if("QUOTA_EXCEEDED_ERR"!==p.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==p.name&&"QuotaExceededError"!==p.name)return void h("Could not add item with key '"+i+"'",p);for(var s,t=[],u=0;u<q.length;u++)if(s=q.key(u),0===s.indexOf(k+r)&&s.indexOf(l)<0){var v=s.substr((k+r).length),w=c(v),x=e(w);x=x?parseInt(x,m):o,t.push({key:v,size:(e(v)||"").length,expiration:x})}t.sort(function(a,b){return b.expiration-a.expiration});for(var y=(j||"").length;t.length&&y>0;)s=t.pop(),h("Cache is full, removing item with key '"+i+"'"),g(s.key),g(c(s.key)),y-=s.size;try{f(i,j)}catch(p){return void h("Could not add item with key '"+i+"', perhaps it's too big?",p)}}n?f(c(i),(d()+n).toString(m)):g(c(i))}},get:function(f){if(!a())return null;var h=c(f),i=e(h);if(i){var j=parseInt(i,m);if(d()>=j)return g(f),g(h),null}var k=e(f);if(!k||!b())return k;try{return JSON.parse(k)}catch(l){return k}},remove:function(b){return a()?(g(b),void g(c(b))):null},supported:function(){return a()},flush:function(){if(a())for(var b=q.length-1;b>=0;--b){var c=q.key(b);0===c.indexOf(k+r)&&q.removeItem(c)}},setBucket:function(a){r=a},resetBucket:function(){r=""},enableSession:function(){q=p.SESSION},enableWarnings:function(a){s=a}};return t});